(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[503],{98229:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/swap",function(){return c(42722)}])},42722:function(e,b,a){"use strict";a.r(b),a.d(b,{default:function(){return s}});var f=a(85893),g=a(10772),h=a(67294),i=a(96352),j=a(42660),k=a(828),l=a(14470),c=a(46852),d=a(86087),m=a.n(d),n=c.nE.BUY,o=function(d){var o=d.assetId,t=d.client,v=d.wallet,w=d.priceList,x=d.link,b=d.destinationValueNumber,q=d.destinationSymbol,r=(0,k.Z)((0,l.Z)(t,o),2),u=r[0],y=r[1],s=(0,h.useState)(o),z=s[0],A=s[1];(0,h.useEffect)(function(){var a=setInterval(function(){void 0!==z&&""!==z?y(z):y(o)},j.Z.UPDATE_DETAILS_INTERVAL);return function(){return clearInterval(a)}},[o]);var a=(0,h.useMemo)(function(){return c.fz.TransformAsset(u,v,w,o,n)},[u]),B=function(b){""===q||"ETH"===q||"0x64ff637fb478863b7468bc97d30a5bf3a428a1fd"===q?x.sell({amount:b,tokenId:a.tokenId,tokenAddress:j.Z.IMMUTASWAP_CONTRACT_ADDRESS}).then(function(){n=c.nE.CANCEL}).catch(function(a){n=c.nE.SELL}):x.sell({currencyAddress:i.Z.ConvertTokenToAddress(q,w),amount:b,tokenId:a.tokenId,tokenAddress:j.Z.IMMUTASWAP_CONTRACT_ADDRESS}).then(function(){n=c.nE.CANCEL}).catch(function(a){n=c.nE.SELL})},C=function(){A(o),x.buy({orderIds:[a.orderIdString]}).then(function(){n=c.nE.BUY}).catch(function(){})},p="https://immutascan.io/address/".concat(j.Z.IMMUTASWAP_CONTRACT_ADDRESS,"/",o),g=(0,f.jsx)(f.Fragment,{}),e=c.fz.ImageUrlMapper(a.imgUrl);return a.isOwned||a.isListed?!a.isOwned&&a.isListed?g=(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{children:(0,f.jsx)("img",{src:e})}),(0,f.jsx)("div",{children:"To swap tokens, purchase this ImmutaBuck and then sell it back to us. The buy-back process should take less than 5 minutes."}),(0,f.jsxs)("button",{onClick:function(){return C()},children:["Buy for ",a.listPrice]}),(0,f.jsxs)("button",{disabled:!0,onClick:function(){return B(b.toString())},children:["Sell for ",b.toString()]})]}):a.isOwned&&!a.isListed?g=(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{children:(0,f.jsx)("img",{src:e})}),(0,f.jsxs)("div",{children:["You have successfully bought this ImmutaBuck. Click the Sell button below to complete the process. You can view this transaction at ",(0,f.jsx)("a",{target:"_blank",href:p,children:"Immutascan.io"}),"."]}),(0,f.jsx)("button",{disabled:!0,children:"You own this"}),(0,f.jsxs)("button",{onClick:function(){return B(b.toString())},children:["Sell for ",b.toString()]})]}):a.isOwned&&a.isListed&&(g=q!==a.symbol?(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{children:(0,f.jsx)("img",{src:e})}),(0,f.jsx)("button",{disabled:!0,children:"You own this"}),(0,f.jsxs)("button",{onClick:function(){return B(b.toString())},children:["Re-list for ",b.toString()]}),(0,f.jsxs)("div",{children:["You own this but it is listed for ",a.listPrice," ",a.symbol,". Please relist for ",b," ",q,"."]})]}):b>a.listPrice?(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{children:(0,f.jsx)("img",{src:e})}),(0,f.jsx)("button",{disabled:!0,children:"You own this"}),(0,f.jsxs)("button",{onClick:function(){return B(b.toString())},children:["Re-list for ",b.toString()]}),(0,f.jsxs)("div",{children:["Listed price is ",a.listPrice," which is below the buyback price of ",b,". Please relist this to sell. ",(0,f.jsx)("a",{target:"_blank",href:p,children:"Immutascan.io"}),"."]})]}):(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{children:(0,f.jsx)("img",{src:e})}),(0,f.jsx)("button",{disabled:!0,children:"You own this"}),(0,f.jsxs)("button",{onClick:function(){return B(b.toString())},children:["Re-list for ",b.toString()]}),(0,f.jsxs)("div",{children:["Buy-back is in progress. This should take less than 5 minutes. You can view this transaction at ",(0,f.jsx)("a",{target:"_blank",href:p,children:"Immutascan.io"}),"."]})]})):g=(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{children:(0,f.jsx)("img",{src:e})}),(0,f.jsxs)("div",{children:["Transaction complete. View the transaction at ",(0,f.jsx)("a",{target:"_blank",href:p,rel:"noreferrer",children:"Immutascan.io"}),"."]})]}),(0,f.jsx)("div",{className:m().action_container,children:g})},p=a(50796),q=void 0,r=function(){var c=(0,p.bp)(),a=c.priceList,z=c.liquidityBalances,G=c.allAssets,A=c.client,B=c.link,r=c.wallet,s=(0,h.useState)(a.ETH.address),l=s[0],H=s[1],t=(0,h.useState)(a.GODS.address),n=t[0],I=t[1],u=(0,h.useState)("5"),g=u[0],J=u[1],v=(0,h.useState)(!1),w=v[0],K=v[1],L=(0,h.useRef)(a.ETH.address),M=(0,h.useRef)(a.GODS.address),C=function(b,c){if(0!==G.length){q=void 0;var a=G.filter(function(a){if(a.usdcVal.toString()===b&&a.listSymbol===c&&a.percentAboveMarket<10)return!0});a.length>0&&(q=a[0])}};(0,h.useEffect)(function(){K(!1)},[l,n,g]);var b=i.Y.ConvertAddressToToken(n,a),D=i.Y.ConvertAddressToToken(l,a);void 0===q&&C(g,D);var e=parseFloat(i.Y.CalculatePrice(parseInt(g),b,a))*(1-j.Z.fees-j.Z.FEES_SAFETY_NET);e=parseFloat(i.Y.NumberToDisplayDecimals(e,b));var x=parseFloat(z[b]),E=void 0===q?0:parseFloat(i.Y.NumberToDisplayDecimals(q.listedPrice,q.listSymbol)),y=(0,f.jsx)(f.Fragment,{});w&& void 0!==q&&(y=(0,f.jsx)(o,{priceList:a,link:B,wallet:r,destinationValueNumber:e,assetId:q.tokenId,client:A,destinationSymbol:b}));var k=!w,d="",F=parseFloat(i.Y.CalculatePrice(100,b,a));return x<e?(k=!1,d="Insufficient liquidity for ".concat(b)):void 0===q?(k=!1,d="No ImmutaBucks found matching these values. More should be posted in 5 minutes."):x<F?d="Warning: Low Liquidity for ".concat(b):void 0===r&&(k=!1,d="Connect your wallet to continue."),(0,f.jsx)("div",{children:(0,f.jsxs)("div",{className:m().wizard,children:[(0,f.jsx)("h1",{children:"Quickly exchange crypto on IMX L2"}),(0,f.jsxs)("div",{className:m().flexContainer,children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("p",{children:"You can use ImmutaSwap.io to exchange Cryptocurrency locked on Immutable X L2 by buying and selling ImmutaBucks. This wizard will walk you through the process."}),(0,f.jsxs)("p",{children:["If you experience any problems with the Swap Wizard, please check out the help-desk on our ",(0,f.jsx)("a",{href:"https://discord.gg/unSQVeaYGN",children:"discord server"}),"."]})]}),(0,f.jsxs)("div",{children:[(0,f.jsxs)("div",{className:m().usd,children:[(0,f.jsx)("label",{htmlFor:"usd",children:"USD Value to swap"}),(0,f.jsxs)("select",{id:"usd",value:g,onChange:function(b){C(b.target.value,i.Y.ConvertAddressToToken(l,a)),J(b.target.value)},children:[(0,f.jsx)("option",{value:"5",children:"$5"}),(0,f.jsx)("option",{value:"10",children:"$10"}),(0,f.jsx)("option",{value:"20",children:"$20"}),(0,f.jsx)("option",{value:"50",children:"$50"}),(0,f.jsx)("option",{value:"100",children:"$100"})]})]}),(0,f.jsxs)("div",{className:m().source,children:[(0,f.jsxs)("label",{children:["Send ",E.toString()," "]}),(0,f.jsx)("select",{name:"sourceSymbol",value:l,onChange:function(b){C(g,i.Y.ConvertAddressToToken(b.target.value,a)),b.target.value===n&&(I(L.current),M.current=L.current),L.current=b.target.value,H(b.target.value)},children:Object.keys(a).map(function(b){var c=a[b];return(0,f.jsx)("option",{value:c.address,children:b},b)})})]}),(0,f.jsxs)("div",{className:m().destination,children:[(0,f.jsxs)("label",{children:["Get ",e.toString()," "]}),(0,f.jsx)("select",{name:"destinationSymbol",value:n,onChange:function(b){b.target.value===l&&(C(g,i.Y.ConvertAddressToToken(M.current,a)),H(M.current),L.current=M.current),M.current=b.target.value,I(b.target.value)},children:Object.keys(a).map(function(b){var c=a[b];return(0,f.jsx)("option",{value:c.address,children:b},b)})})]}),(0,f.jsx)("div",{className:m().fees,children:"Includes 5% in fees"}),(0,f.jsx)("div",{className:m().fees,children:"(2% protocol fee, 0.5% Royalty, applied twice for buying and selling ImmutaBucks)"}),(0,f.jsx)("div",{style:k?{}:{display:"none"},children:(0,f.jsx)("button",{onClick:function(){return K(!0)},children:"Continue"})})]})]}),(0,f.jsxs)("div",{children:[y,(0,f.jsx)("div",{className:m().message,style:""===d?{display:"none"}:{},children:d})]})]})})},s=function(){return(0,f.jsx)(f.Fragment,{children:(0,f.jsx)(g.Z,{tsxContent:(0,f.jsx)(r,{})})})}},14470:function(d,b,a){"use strict";var e=a(47568),c=a(34051),f=a.n(c),g=a(30446),h=a(67294),i=a(42660),j=!1;b.Z=function(b,c){var d=function(a){!j&& void 0!==b&&""!==a&&0!==Object.keys(b).length&&(j=!0,Promise.all([m(),o()]).then(function(a){j=!1,l({asset:a[1],order:a[0].result[0]})}).catch(function(){j=!1,console.error("Problem fetching AssetId ",a)}))},a=(0,h.useState)(),k=a[0],l=a[1];function m(){return n.apply(this,arguments)}function n(){return(n=(0,e.Z)(f().mark(function a(){return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",b.getOrders({sell_token_id:c,sell_token_address:i.Z.IMMUTASWAP_CONTRACT_ADDRESS.toString(),status:g.aRe.active}));case 1:case"end":return a.stop()}},a)}))).apply(this,arguments)}function o(){return p.apply(this,arguments)}function p(){return(p=(0,e.Z)(f().mark(function a(){return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",b.getAsset({address:i.Z.IMMUTASWAP_CONTRACT_ADDRESS.toString(),id:c,include_fees:!0}));case 1:case"end":return a.stop()}},a)}))).apply(this,arguments)}return(0,h.useEffect)(function(){d(c),console.log("DEBUG Changed Asset to ",c)},[b,c]),[k,d]}},86087:function(a){a.exports={wizard:"wizard_wizard__udno4",flexContainer:"wizard_flexContainer__x6hua",message:"wizard_message__CN_Qm",action_container:"wizard_action_container__3pVNp"}}},function(a){a.O(0,[664,772,774,888,179],function(){var b;return a(a.s=98229)}),_N_E=a.O()}])